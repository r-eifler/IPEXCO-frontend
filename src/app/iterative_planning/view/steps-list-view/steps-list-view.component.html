@let planProperties = planProperties$ | async;

<app-page>
  <app-breadcrumb>
    <a *isProject app-breadcrumb-item [routerLink]="['/project/' + (project$ | async)?._id]"><mat-icon>home</mat-icon></a>
    <app-breadcrumb-item>All Iterations</app-breadcrumb-item>
  </app-breadcrumb>
  <app-page-title>Plan Iterations</app-page-title>

  <app-page-hero *isDemo>
    <app-steps-list-hero></app-steps-list-hero>
  </app-page-hero>

  <app-page-content>
    <app-page-section-list>

      <app-page-section *isDemo>
        <app-page-section-title>
          Task Information
        </app-page-section-title>
        <app-page-section-content>
          <app-demo-info [demo]="project$ | async"></app-demo-info>
        </app-page-section-content>
      </app-page-section>

      <app-page-section>
        <app-page-section-content>
          <div class="page-grid">
            @for(step of steps$ | async; track step) {
              <app-iteration-step-card 
                [step]="step" 
                [planProperties]="planProperties" 
                (fork)="createNewIteration(step._id)"
                (cancel)="cancelIterationStep(step._id)">
              </app-iteration-step-card>
            }

            <button app-action-card (click)="createNewIteration()">
              <div class="instructions">
                <span>Perform a new plan computation from scratch</span>
                <span class="alternative">or</span>
                <span> fork (<mat-icon>call_split</mat-icon>) an existing one.</span>
              </div>
              <mat-icon>add</mat-icon>
            </button>

          </div>
        </app-page-section-content>
      </app-page-section> 

    </app-page-section-list>
  </app-page-content>
</app-page>
